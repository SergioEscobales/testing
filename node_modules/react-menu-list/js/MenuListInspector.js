"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.MenuListInspectorContext = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _ChosenEvent = _interopRequireDefault(require("./events/ChosenEvent"));

var MenuListInspectorContext = _react["default"].createContext(null);

exports.MenuListInspectorContext = MenuListInspectorContext;

var MenuListInspector =
/*#__PURE__*/
function (_React$Component) {
  (0, _inherits2["default"])(MenuListInspector, _React$Component);

  function MenuListInspector() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2["default"])(this, MenuListInspector);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2["default"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3["default"])(MenuListInspector)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_descendantMenuLists", []);
    (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_menuListInspectorContext", {
      registerMenuList: function registerMenuList(menuList) {
        _this._descendantMenuLists.push(menuList);
      },
      unregisterMenuList: function unregisterMenuList(menuList) {
        var i = _this._descendantMenuLists.indexOf(menuList);

        if (i < 0) throw new Error('MenuList not registered');

        _this._descendantMenuLists.splice(i, 1);
      },
      dispatchEvent: function dispatchEvent(event) {
        switch (event.type) {
          case 'chosen':
            /*:: if (!(event instanceof ChosenEvent)) throw new Error(); */
            if (_this.props.onItemChosen) _this.props.onItemChosen(event);
            break;

          case 'left':
            if (_this.props.onLeftPushed) _this.props.onLeftPushed(event);
            break;

          case 'right':
            if (_this.props.onRightPushed) _this.props.onRightPushed(event);
            break;
        }

        if (event.cancelBubble) return;

        var parentCtx = _this._parentCtx();

        if (parentCtx) {
          parentCtx.dispatchEvent(event);
        }
      }
    });
    return _this;
  }

  (0, _createClass2["default"])(MenuListInspector, [{
    key: "_parentCtx",
    value: function _parentCtx() {
      return this.context;
    }
  }, {
    key: "moveCursor",
    value: function moveCursor(direction, prevCursorLocation) {
      var menuList = this._descendantMenuLists[0];

      if (!menuList) {
        return false;
      }

      menuList.moveCursor(direction, prevCursorLocation);
      return true;
    }
  }, {
    key: "hasHighlight",
    value: function hasHighlight() {
      for (var i = 0, len = this._descendantMenuLists.length; i < len; i++) {
        if (this._descendantMenuLists[i].hasHighlight()) {
          return true;
        }
      }

      return false;
    }
  }, {
    key: "render",
    value: function render() {
      return _react["default"].createElement(MenuListInspectorContext.Provider, {
        value: this._menuListInspectorContext
      }, this.props.children);
    }
  }]);
  return MenuListInspector;
}(_react["default"].Component);

exports["default"] = MenuListInspector;
(0, _defineProperty2["default"])(MenuListInspector, "propTypes", {
  onItemChosen: _propTypes["default"].func,
  onLeftPushed: _propTypes["default"].func,
  onRightPushed: _propTypes["default"].func,
  children: _propTypes["default"].element
});
(0, _defineProperty2["default"])(MenuListInspector, "contextType", MenuListInspectorContext);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9NZW51TGlzdEluc3BlY3Rvci5qcyJdLCJuYW1lcyI6WyJNZW51TGlzdEluc3BlY3RvckNvbnRleHQiLCJSZWFjdCIsImNyZWF0ZUNvbnRleHQiLCJNZW51TGlzdEluc3BlY3RvciIsInJlZ2lzdGVyTWVudUxpc3QiLCJtZW51TGlzdCIsIl9kZXNjZW5kYW50TWVudUxpc3RzIiwicHVzaCIsInVucmVnaXN0ZXJNZW51TGlzdCIsImkiLCJpbmRleE9mIiwiRXJyb3IiLCJzcGxpY2UiLCJkaXNwYXRjaEV2ZW50IiwiZXZlbnQiLCJ0eXBlIiwicHJvcHMiLCJvbkl0ZW1DaG9zZW4iLCJvbkxlZnRQdXNoZWQiLCJvblJpZ2h0UHVzaGVkIiwiY2FuY2VsQnViYmxlIiwicGFyZW50Q3R4IiwiX3BhcmVudEN0eCIsImNvbnRleHQiLCJkaXJlY3Rpb24iLCJwcmV2Q3Vyc29yTG9jYXRpb24iLCJtb3ZlQ3Vyc29yIiwibGVuIiwibGVuZ3RoIiwiaGFzSGlnaGxpZ2h0IiwiX21lbnVMaXN0SW5zcGVjdG9yQ29udGV4dCIsImNoaWxkcmVuIiwiQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwiZnVuYyIsImVsZW1lbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUE7O0FBRUE7O0FBR0E7O0FBU08sSUFBTUEsd0JBQXdCLEdBQUdDLGtCQUFNQyxhQUFOLENBQW9ELElBQXBELENBQWpDOzs7O0lBU2NDLGlCOzs7Ozs7Ozs7Ozs7Ozs7Ozs2R0FXcUIsRTtrSEFNbUI7QUFDekRDLE1BQUFBLGdCQUFnQixFQUFFLDBCQUFDQyxRQUFELEVBQXdCO0FBQ3hDLGNBQUtDLG9CQUFMLENBQTBCQyxJQUExQixDQUErQkYsUUFBL0I7QUFDRCxPQUh3RDtBQUl6REcsTUFBQUEsa0JBQWtCLEVBQUUsNEJBQUNILFFBQUQsRUFBd0I7QUFDMUMsWUFBTUksQ0FBQyxHQUFHLE1BQUtILG9CQUFMLENBQTBCSSxPQUExQixDQUFrQ0wsUUFBbEMsQ0FBVjs7QUFDQSxZQUFJSSxDQUFDLEdBQUcsQ0FBUixFQUFXLE1BQU0sSUFBSUUsS0FBSixDQUFVLHlCQUFWLENBQU47O0FBQ1gsY0FBS0wsb0JBQUwsQ0FBMEJNLE1BQTFCLENBQWlDSCxDQUFqQyxFQUFvQyxDQUFwQztBQUNELE9BUndEO0FBU3pESSxNQUFBQSxhQUFhLEVBQUUsdUJBQUNDLEtBQUQsRUFBc0I7QUFDbkMsZ0JBQVFBLEtBQUssQ0FBQ0MsSUFBZDtBQUNBLGVBQUssUUFBTDtBQUNFO0FBQ0EsZ0JBQUksTUFBS0MsS0FBTCxDQUFXQyxZQUFmLEVBQTZCLE1BQUtELEtBQUwsQ0FBV0MsWUFBWCxDQUF3QkgsS0FBeEI7QUFDN0I7O0FBQ0YsZUFBSyxNQUFMO0FBQ0UsZ0JBQUksTUFBS0UsS0FBTCxDQUFXRSxZQUFmLEVBQTZCLE1BQUtGLEtBQUwsQ0FBV0UsWUFBWCxDQUF3QkosS0FBeEI7QUFDN0I7O0FBQ0YsZUFBSyxPQUFMO0FBQ0UsZ0JBQUksTUFBS0UsS0FBTCxDQUFXRyxhQUFmLEVBQThCLE1BQUtILEtBQUwsQ0FBV0csYUFBWCxDQUF5QkwsS0FBekI7QUFDOUI7QUFWRjs7QUFZQSxZQUFJQSxLQUFLLENBQUNNLFlBQVYsRUFBd0I7O0FBQ3hCLFlBQU1DLFNBQVMsR0FBRyxNQUFLQyxVQUFMLEVBQWxCOztBQUNBLFlBQUlELFNBQUosRUFBZTtBQUNiQSxVQUFBQSxTQUFTLENBQUNSLGFBQVYsQ0FBd0JDLEtBQXhCO0FBQ0Q7QUFDRjtBQTNCd0QsSzs7Ozs7O2lDQUpkO0FBQzNDLGFBQU8sS0FBS1MsT0FBWjtBQUNEOzs7K0JBZ0NVQyxTLEVBQXNCQyxrQixFQUFvQztBQUNuRSxVQUFNcEIsUUFBUSxHQUFHLEtBQUtDLG9CQUFMLENBQTBCLENBQTFCLENBQWpCOztBQUNBLFVBQUksQ0FBQ0QsUUFBTCxFQUFlO0FBQ2IsZUFBTyxLQUFQO0FBQ0Q7O0FBQ0RBLE1BQUFBLFFBQVEsQ0FBQ3FCLFVBQVQsQ0FBb0JGLFNBQXBCLEVBQStCQyxrQkFBL0I7QUFDQSxhQUFPLElBQVA7QUFDRDs7O21DQUV1QjtBQUN0QixXQUFLLElBQUloQixDQUFDLEdBQUMsQ0FBTixFQUFTa0IsR0FBRyxHQUFDLEtBQUtyQixvQkFBTCxDQUEwQnNCLE1BQTVDLEVBQW9EbkIsQ0FBQyxHQUFDa0IsR0FBdEQsRUFBMkRsQixDQUFDLEVBQTVELEVBQWdFO0FBQzlELFlBQUksS0FBS0gsb0JBQUwsQ0FBMEJHLENBQTFCLEVBQTZCb0IsWUFBN0IsRUFBSixFQUFpRDtBQUMvQyxpQkFBTyxJQUFQO0FBQ0Q7QUFDRjs7QUFDRCxhQUFPLEtBQVA7QUFDRDs7OzZCQUVRO0FBQ1AsYUFDRSxnQ0FBQyx3QkFBRCxDQUEwQixRQUExQjtBQUFtQyxRQUFBLEtBQUssRUFBRSxLQUFLQztBQUEvQyxTQUNHLEtBQUtkLEtBQUwsQ0FBV2UsUUFEZCxDQURGO0FBS0Q7OztFQXZFNEM5QixrQkFBTStCLFM7OztpQ0FBaEM3QixpQixlQUNBO0FBQ2pCYyxFQUFBQSxZQUFZLEVBQUVnQixzQkFBVUMsSUFEUDtBQUVqQmhCLEVBQUFBLFlBQVksRUFBRWUsc0JBQVVDLElBRlA7QUFHakJmLEVBQUFBLGFBQWEsRUFBRWMsc0JBQVVDLElBSFI7QUFLakJILEVBQUFBLFFBQVEsRUFBRUUsc0JBQVVFO0FBTEgsQztpQ0FEQWhDLGlCLGlCQVNFSCx3QiIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgdHlwZSB7Tm9kZSBhcyBSZWFjdE5vZGV9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgdHlwZSBNZW51TGlzdCBmcm9tICcuL01lbnVMaXN0JztcbmltcG9ydCB0eXBlIE1lbnVFdmVudCBmcm9tICcuL2V2ZW50cy9NZW51RXZlbnQnO1xuaW1wb3J0IENob3NlbkV2ZW50IGZyb20gJy4vZXZlbnRzL0Nob3NlbkV2ZW50JztcbmltcG9ydCB0eXBlIHtEaXJlY3Rpb24sIFJlY3R9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgdHlwZSBNZW51TGlzdEluc3BlY3RvckNvbnRleHRWYWx1ZSA9IHtcbiAgcmVnaXN0ZXJNZW51TGlzdChtZW51TGlzdDogTWVudUxpc3QpOiB2b2lkO1xuICB1bnJlZ2lzdGVyTWVudUxpc3QobWVudUxpc3Q6IE1lbnVMaXN0KTogdm9pZDtcbiAgZGlzcGF0Y2hFdmVudChldmVudDogTWVudUV2ZW50KTogdm9pZDtcbn07XG5cbmV4cG9ydCBjb25zdCBNZW51TGlzdEluc3BlY3RvckNvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0PD9NZW51TGlzdEluc3BlY3RvckNvbnRleHRWYWx1ZT4obnVsbCk7XG5cbmV4cG9ydCB0eXBlIFByb3BzID0ge1xuICBvbkl0ZW1DaG9zZW4/OiAoZXZlbnQ6IENob3NlbkV2ZW50KSA9PiB2b2lkO1xuICBvbkxlZnRQdXNoZWQ/OiAoZXZlbnQ6IE1lbnVFdmVudCkgPT4gdm9pZDtcbiAgb25SaWdodFB1c2hlZD86IChldmVudDogTWVudUV2ZW50KSA9PiB2b2lkO1xuICBjaGlsZHJlbjogUmVhY3ROb2RlO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWVudUxpc3RJbnNwZWN0b3IgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICBvbkl0ZW1DaG9zZW46IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uTGVmdFB1c2hlZDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25SaWdodFB1c2hlZDogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmVsZW1lbnRcbiAgfTtcblxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBNZW51TGlzdEluc3BlY3RvckNvbnRleHQ7XG5cbiAgX2Rlc2NlbmRhbnRNZW51TGlzdHM6IEFycmF5PE1lbnVMaXN0PiA9IFtdO1xuXG4gIF9wYXJlbnRDdHgoKTogP01lbnVMaXN0SW5zcGVjdG9yQ29udGV4dFZhbHVlIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0O1xuICB9XG5cbiAgX21lbnVMaXN0SW5zcGVjdG9yQ29udGV4dDogTWVudUxpc3RJbnNwZWN0b3JDb250ZXh0VmFsdWUgPSB7XG4gICAgcmVnaXN0ZXJNZW51TGlzdDogKG1lbnVMaXN0OiBNZW51TGlzdCkgPT4ge1xuICAgICAgdGhpcy5fZGVzY2VuZGFudE1lbnVMaXN0cy5wdXNoKG1lbnVMaXN0KTtcbiAgICB9LFxuICAgIHVucmVnaXN0ZXJNZW51TGlzdDogKG1lbnVMaXN0OiBNZW51TGlzdCkgPT4ge1xuICAgICAgY29uc3QgaSA9IHRoaXMuX2Rlc2NlbmRhbnRNZW51TGlzdHMuaW5kZXhPZihtZW51TGlzdCk7XG4gICAgICBpZiAoaSA8IDApIHRocm93IG5ldyBFcnJvcignTWVudUxpc3Qgbm90IHJlZ2lzdGVyZWQnKTtcbiAgICAgIHRoaXMuX2Rlc2NlbmRhbnRNZW51TGlzdHMuc3BsaWNlKGksIDEpO1xuICAgIH0sXG4gICAgZGlzcGF0Y2hFdmVudDogKGV2ZW50OiBNZW51RXZlbnQpID0+IHtcbiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgY2FzZSAnY2hvc2VuJzpcbiAgICAgICAgLyo6OiBpZiAoIShldmVudCBpbnN0YW5jZW9mIENob3NlbkV2ZW50KSkgdGhyb3cgbmV3IEVycm9yKCk7ICovXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uSXRlbUNob3NlbikgdGhpcy5wcm9wcy5vbkl0ZW1DaG9zZW4oZXZlbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2xlZnQnOlxuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbkxlZnRQdXNoZWQpIHRoaXMucHJvcHMub25MZWZ0UHVzaGVkKGV2ZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgIGlmICh0aGlzLnByb3BzLm9uUmlnaHRQdXNoZWQpIHRoaXMucHJvcHMub25SaWdodFB1c2hlZChldmVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmNhbmNlbEJ1YmJsZSkgcmV0dXJuO1xuICAgICAgY29uc3QgcGFyZW50Q3R4ID0gdGhpcy5fcGFyZW50Q3R4KCk7XG4gICAgICBpZiAocGFyZW50Q3R4KSB7XG4gICAgICAgIHBhcmVudEN0eC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgbW92ZUN1cnNvcihkaXJlY3Rpb246IERpcmVjdGlvbiwgcHJldkN1cnNvckxvY2F0aW9uOiA/UmVjdCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG1lbnVMaXN0ID0gdGhpcy5fZGVzY2VuZGFudE1lbnVMaXN0c1swXTtcbiAgICBpZiAoIW1lbnVMaXN0KSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIG1lbnVMaXN0Lm1vdmVDdXJzb3IoZGlyZWN0aW9uLCBwcmV2Q3Vyc29yTG9jYXRpb24pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgaGFzSGlnaGxpZ2h0KCk6IGJvb2xlYW4ge1xuICAgIGZvciAobGV0IGk9MCwgbGVuPXRoaXMuX2Rlc2NlbmRhbnRNZW51TGlzdHMubGVuZ3RoOyBpPGxlbjsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5fZGVzY2VuZGFudE1lbnVMaXN0c1tpXS5oYXNIaWdobGlnaHQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8TWVudUxpc3RJbnNwZWN0b3JDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt0aGlzLl9tZW51TGlzdEluc3BlY3RvckNvbnRleHR9PlxuICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cbiAgICAgIDwvTWVudUxpc3RJbnNwZWN0b3JDb250ZXh0LlByb3ZpZGVyPlxuICAgICk7XG4gIH1cbn1cbiJdfQ==